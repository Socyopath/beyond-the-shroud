# decision_bts_shroud_rift_summon_1 = {
# 	sound = event_energy_field
# 	icon = decision_wormhole
#     owned_planets_only = no

# 	resources = {
# 		category = decisions
# 		cost = {
# 			# astral_threads = @decision_bts_zroni_astral_spliting_astral_threads_cost
#             # energy = 100
# 		}
# 	}

# 	potential = {
#         is_planet_class = pc_bts_shroud_rift
# 		exists = solar_system.owner
#         solar_system.owner = {
#             has_crisis_perk = bts_menp_mega_summon_1
#         }
# 	}

#     allow = {
#         custom_tooltip = {
#             fail_text = decision_bts_shroud_rift_summon_cooldown
#             solar_system.owner = {
#                 NOT = {
#                     has_modifier = shroud_cooldown
#                 }
#             }
#         }
#     }

# 	effect = {
#         custom_tooltip = decision_bts_shroud_rift_summon_1_effect
#         solar_system.owner = {
#             add_modifier = {
#                 modifier = "shroud_cooldown"
#                 days = @bts_power_summon_1_shroud_delve_cooldown
#                 time_multiplier = value:scripted_modifier_mult|MODIFIER|shroud_delve_cooldown|
#             }
#             hidden_effect = {
#                 country_event = { id = bts.310 }
#             }
#         }
# 	}
# }

# Rituals
bts_ritual_pop_trade = {
	sound = event_energy_field
	icon = decision_wormhole
    owned_planets_only = no

	potential = {
        is_planet_class = pc_bts_shroud_rift
		exists = solar_system.owner
        solar_system.owner = {
            has_crisis_perk = bts_menp_mega
        }
	}

    allow = {
        bts_crisis_ritual_can_use_cooldown = yes

        if = {
            limit = { 
                solar_system.owner = {
                    bts_can_use_councilor_ultimate_power = { COUNCILOR = bts_crisis_councilor_ritual } 
                }
            }
            bts_crisis_ritual_can_use_cost = {
                COST = @bts_ritual_pop_trade_custom_thrall_cost
            }
        }
        else = {
            bts_crisis_ritual_can_use_cost = {
                COST = @bts_ritual_pop_trade_thrall_cost
            }
        }

    }

	effect = {
        custom_tooltip = bts_ritual_pop_trade_effects

        hidden_effect = {
            solar_system.owner.capital_scope = {
                create_pop = {
                    species = owner_main_species
                }
            }
        }
        if = {
            limit = {
                solar_system.owner = {
                    bts_can_use_councilor_power = { COUNCILOR = bts_crisis_councilor_ritual }
                }
            }
            custom_tooltip = bts_ritual_pop_trade_bonus_effect
            hidden_effect = {
                add_modifier = {
                    modifier = bts_ritual_pop_trade_boost
                    days = @bts_ritual_pop_trade_boost_duration
                }
            }
        }

        if = {
            limit = { 
                solar_system.owner = {
                    bts_can_use_councilor_ultimate_power = { COUNCILOR = bts_crisis_councilor_ritual } 
                }
            }
            bts_crisis_ritual_setup = {
                COST = @bts_ritual_pop_trade_custom_thrall_cost
                COOLDOWN = @bts_ritual_pop_trade_cooldown
            }
        }
        else = {
            bts_crisis_ritual_setup = {
                COST = @bts_ritual_pop_trade_thrall_cost
                COOLDOWN = @bts_ritual_pop_trade_cooldown
            }
        }
	}
}

bts_ritual_remove_trait = {
	sound = event_energy_field
	icon = decision_wormhole
    owned_planets_only = no

	potential = {
        is_planet_class = pc_bts_shroud_rift
		exists = solar_system.owner
        solar_system.owner = {
            has_crisis_perk = bts_menp_mega
        }
	}

    allow = {
        bts_crisis_ritual_can_use_cooldown = yes
        bts_crisis_ritual_can_use_cost = {
            COST = @bts_ritual_remove_trait_thrall_cost
        }
        solar_system = {
            owner = {
                any_owned_leader = {
                    num_leader_traits = {
                        value > 0
                        negative = yes
                    }
                }
            }
        }
    }

	effect = {
        custom_tooltip = bts_ritual_remove_trait_effects
        bts_crisis_ritual_setup = {
            COST = @bts_ritual_remove_trait_thrall_cost
            COOLDOWN = @bts_ritual_remove_trait_cooldown
        }

        hidden_effect = {
            solar_system.owner = {
                random_owned_leader = {
                    limit = {
                        num_leader_traits = {
                            value > 0
                            negative = yes
                        }
                    }
                    remove_trait = all_negative
                }
            }
        }

	}
}

bts_ritual_reset_leader = {
	sound = event_energy_field
	icon = decision_wormhole
    owned_planets_only = no

	potential = {
        is_planet_class = pc_bts_shroud_rift
		exists = solar_system.owner
        solar_system.owner = {
            has_crisis_perk = bts_menp_mega
        }
	}

    allow = {
        bts_crisis_ritual_can_use_cooldown = yes
        bts_crisis_ritual_can_use_cost = {
            COST = @bts_ritual_reset_leader_thrall_cost
        }
    }

	effect = {
        custom_tooltip = bts_ritual_reset_leader_effects
        bts_crisis_ritual_setup = {
            COST = @bts_ritual_reset_leader_thrall_cost
            COOLDOWN = @bts_ritual_reset_leader_cooldown
        }

        hidden_effect = {
            solar_system.owner = {
                country_event = { id = bts.502 }
            }
        }

	}
}


bts_shroud_rift_harvest = {
    sound = event_energy_field
	icon = decision_wormhole
    owned_planets_only = no

	resources = {
		category = decisions
		cost = {
            energy = @bts_shroud_rift_harvest_cost_energy
			astral_threads = @bts_shroud_rift_harvest_cost_astral_threads
		}
	}

	potential = {
        is_planet_class = pc_bts_shroud_rift
		exists = solar_system.owner
        solar_system.owner = {
            has_crisis_perk = bts_menp_energy
        }
	}

	effect = {
        custom_tooltip = bts_shroud_rift_harvest_effects
        hidden_effect = {
            random_list = {
                1 = {
                    bts_add_random_deposit = {
                        BASIC_COUNT = @bts_shroud_rift_harvest_high_basic
                        TECH_COUNT = @bts_shroud_rift_harvest_high_tech
                        SR_COUNT = @bts_shroud_rift_harvest_high_sr
                    }
                }
                2 = {
                    bts_add_random_deposit = {
                        BASIC_COUNT = @bts_shroud_rift_harvest_medium_basic
                        TECH_COUNT = @bts_shroud_rift_harvest_medium_tech
                        SR_COUNT = @bts_shroud_rift_harvest_medium_sr
                    }
                }
                3 = {
                    bts_add_random_deposit = {
                        BASIC_COUNT = @bts_shroud_rift_harvest_low_basic
                        TECH_COUNT = @bts_shroud_rift_harvest_low_tech
                        SR_COUNT = @bts_shroud_rift_harvest_low_sr
                    }
                }
            }
        }
	}
}



# decision_bts_shroud_rift_summon_4 = {
# 	sound = event_energy_field
# 	icon = decision_wormhole
#     owned_planets_only = no

# 	resources = {
# 		category = decisions
# 		cost = {
# 			# astral_threads = @decision_bts_zroni_astral_spliting_astral_threads_cost
#             # energy = 100
# 		}
# 	}

# 	potential = {
#         is_planet_class = pc_bts_shroud_rift
# 		exists = solar_system.owner
#         solar_system.owner = {
#             has_crisis_perk = bts_menp_mega_summon_4
#         }
# 	}

#     allow = {
#         custom_tooltip = {
#             fail_text = decision_bts_shroud_rift_summon_cooldown
#             solar_system.owner = {
#                 NOT = {
#                     has_modifier = shroud_cooldown
#                 }
#             }
#         }
#         custom_tooltip = { 
#             fail_text = decision_bts_shroud_rift_summon_4_invalid_number 
#             count_owned_ship = { 
#                 count < @bts_power_summon_4_max_number 
#                 limit = { is_ship_size = warped_consciousness } 
#             } 
#         }
#     }

# 	effect = {
#         custom_tooltip = decision_bts_shroud_rift_summon_4_effect
#         solar_system.owner = {
#             add_modifier = {
#                 modifier = "shroud_cooldown"
#                 days = @bts_power_summon_4_shroud_delve_cooldown
#                 time_multiplier = value:scripted_modifier_mult|MODIFIER|shroud_delve_cooldown|
#             }
#             hidden_effect = {
#                 country_event = { id = bts.340 }
#             }
#         }
# 	}
# }
